<% include partials/header.ejs %>
<div id="editModal" class="modal fade" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit</h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="edit-task" class="add-task-form">
          <div class="form-row">
            <div class="form-group col-md-12">
              <label for="bucket">Bucket</label>
              <input type="text" class="form-control" name="bucket" id="bucket" value="" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-12">
              <label for="task">Task</label>
              <input type="text" class="form-control" name="task" id="task" value="" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="status">Status</label>
              <select id="status" name="status" class="form-control" required>
                <option selected></option>
                <option>Open</option>
                <option>Closed</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label for="time">Time</label>
              <input type="number" class="form-control" name="time" id="time" value="" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="description">Description</label>
              <input type="text" class="form-control" name="description" id="description" placeholder="Description" value="" required>
            </div>
            <div class="form-group col-md-6">
              <label for="notes">Notes</label>
              <input type="textarea" class="form-control" name="notes" id="notes" placeholder="Notes" value="" required>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
        <button id="submit" type="button" class="btn btn-success">Save changes</button>
      </div>
    </div>
  </div>
</div>
<div id="page" class="index-wrapper mt-0 pr-4 container-fluid task-group bg-light-gray">
  <div id="cont" class="row p-2 pb-0 align-items-start cont">
    <% if (tasks) {%>
    <% if (tasks.length > 0) {%>
    <% tasks.forEach((task, index) => { %>
    <div id="<%= task.id %>" class="card hovergrow mr-3 border-1-gray" data-taskinfo='{"id": "<%= task.id %>", "bucket": "<%= task.bucket %>", "task": "<%= task.task %>", "status": "<%= task.status %>", "time": "<%= task.time %>", "notes": "<%= task.notes %>", "description": "<%= task.description %>"}'>
      <div id="bucket" class="card-header bg-gray text-white text-1-5"><%= task.bucket %></div>
      <div class="card-body bg-dark">
        <h5 id="task" class="card-title bg-gray text-white p-2 text-center rounded-lg"><%= task.task %></h5>
        <ul class="list-group list-group-flush mb-3 wsn">
          <li class="list-group-item bg-dark p-0 text-light align-middle border-top-gray rounded-lg"><label class="m-0 w-25 text-right border-dark border bg-light-gray rounded-left-lg p-1 text-white" for="status">Status:</label><em id="status" class="pl-1"><%= task.status %></em></li>
          <li class="list-group-item bg-dark p-0 text-light align-middle border-top-gray rounded-lg"><label class="m-0 text-right border-dark w-25 border bg-light-gray rounded-left-lg p-1 text-white" for="time">Time Req:</label><em id="time" class="pl-1"><%= task.time %></em></li>
          <li class="list-group-item bg-dark p-0 text-light align-middle border-top-gray rounded-lg"><label class="m-0 text-right border-dark w-25 border bg-light-gray rounded-left-lg p-1 text-white" for="notes">Notes:</label><em id="notes" class="pl-1"><%= task.notes %></em></li>
          <li class="list-group-item bg-dark p-0 text-light align-middle border-top-bottom-gray rounded-lg"><label class="m-0 w-25 text-right border-dark border bg-light-gray rounded-left-lg p-1 text-white" for="desc">Desc:</label><em id="desc" class="pl-1"><%= task.description %></em></li>
        </ul>
        <a href="/delete/<%= task.id %>" class="btn btn-sm btn-danger border border-dark">Delete</a>
        <!--<a href="/edit/<%= task.id %>" rel="noopener" class="btn btn-sm btn-success border border-dark">Edit</a>-->
        <button type="button" class="btn btn-sm btn-warning border border-dark" data-toggle="modal" data-target="#editModal" data-id="<%= task.id %>">Edit</button>
      </div>
    </div>
    <% }) %>
    <% } else { %>
    <p class="text-center">No tasks found. Go <a href="/add">here</a> to add tasks.</p>
    <% } %>
    <% } %>
  </div>
</div>
</div>
<script src="js/task.js" type="application/x-javascript"></script>
<script src="js/group.js" type="application/x-javascript"></script>
<script type="application/x-javascript" src="js/index-html.js"></script>
<script type="text/javascript">
  (function() {
    function scrollHorizontally(e) {
      e = window.event || e;
      var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
      document.getElementById('cont').scrollLeft -= (delta * 40); // Multiplied by 40
      e.preventDefault();
    }
    if (document.getElementById('cont').addEventListener) {
      // IE9, Chrome, Safari, Opera
      document.getElementById('cont').addEventListener("mousewheel", scrollHorizontally, false);
      // Firefox
      document.getElementById('cont').addEventListener("DOMMouseScroll", scrollHorizontally, false);
    } else {
      // IE 6/7/8
      document.getElementById('cont').attachEvent("onmousewheel", scrollHorizontally);
    }
  })();

</script>
</body>

</html>
